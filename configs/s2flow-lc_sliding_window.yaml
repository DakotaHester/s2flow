job:
  name: s2flow_lc_sliding_window
  type: lc_sliding_window
  log_dir: ./logs
  out_dir: ./runs
  add_completed_file: true

data:
  input_path: ../server/dbcenter/products/land/temporalcomposites/CPB_S2L2A_time_composites/2020/annual/17SMB/20200101_20201231/s2_composite_mean.tif
  output_path: ./output/lc_sliding_window/test.tif

sr_model:
  model_type: unet
  sample_size: 256
  in_channels: 8  # 4 SR channels + 4 conditioning channels
  out_channels: 4
  block_out_channels: [64, 128, 256, 512]
  down_block_types: ["DownBlock2D", "DownBlock2D", "DownBlock2D", "DownBlock2D"]
  up_block_types: ["UpBlock2D", "UpBlock2D", "UpBlock2D", "UpBlock2D"]
  layers_per_block: 2
  norm_num_groups: 32
  pretrained_weights: ./runs/s2flow_sr_train/model.pt

lc_model:
  model_type: segformer
  encoder_name: mit_b5
  in_channels: 4
  num_classes: 5
  pretrained_weights: ./runs/s2flow_lc_sampling_steps_sweep/20251126_165107/steps_1/segformer/fold_2/lc_step1_segformer_f2/model.pt

sampling:
  solver: euler
  num_steps: 1
  fixed_noise: true
  show_pbar: false

inference:
  tile_size: 64           # Input tile size at S2 10m resolution
  stride: 32              # Stride at S2 resolution (50% overlap)
  batch_size: 32          # Number of tiles per batch
  gaussian_sigma: 92      # Sigma for Gaussian weighting (at output resolution)
  tta: false              # Enable test-time augmentation
  tta_passes: 1           # Number of TTA passes to average
  upscale_factor: 4       # SR upscale factor
  enable_pbar: true       # Show progress bar
  save_probs: false       # Save probability maps in addition to predictions
  save_colormap: true
  colormap:
    0: [0, 0, 0, 0]           # Nodata: Transparent
    1: [81, 108, 151, 255]    # Open Water
    2: [179, 253, 214, 255]   # Low Vegetation/Herbaceous
    3: [55, 120, 78, 255]     # Woody Vegetation/Tree Canopy
    4: [152, 152, 153, 255]   # Impervious Surfaces/Structures
    5: [74, 37, 20, 255]      # Barren Land

hyperparameters:
  use_amp: true
